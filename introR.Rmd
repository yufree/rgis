---
title: "地理信息系统中的R－R语言初步"
author: "Miao YU"
date: "2014年12月2日"
output: html_document
---

现在你应该已经按照官方指引安装了R，这里推荐但不强制安装另一个R的工作界面：RStudio，请也按照[官方](http://www.rstudio.com)指引安装。

OK，请打开RStudio，我们会看到四个模块，有一个console，这与R的命令行界面等同。R语言是运行在命令行模式下的，换言之，你输入命令，R会根据命令来进行运算，一般会返回一个结果。例如我们输入下面的命令：

```{r}
1+1
```

我们可以得到输出，这里注意，加号实际代表了一种运算方法，数字1代表了数据。也就是说，在命令行下，我们告诉R数据与要处理的方法就能得到处理后的答案。要处理的方法可以是简单的加减乘除，也可以是对很多复杂运算的打包，也就是函数，你要是熟悉tex语言，可以把命令看作控制序列，数据看作字符，本质上是一样的。函数可以处理数据，也可以处理函数，我们这里通称为对象，例如：

```{r}
help(sum)
```

你就应该看到关于sum的帮助文件，仔细想想，每条命令会有一个函数名称，也会有要处理的对象，而这个对象会放到函数后的括号中，如果有其他参数呢？拿逗号分割都放到括号里就完了。

现在我们不管函数对象，先考虑数据。R里面的数据对象可以用向量去存储，例如：

```{r}
a <- c(1,2,3)
```

`a`是我们储存数据对象的名字， `<-` 是赋值符号，`c()` 是将数据储存为向量的意思, 里面逗号分割的数字就是一个向量里的元素。这条命令翻译成人话就是：把1，2，3这三个数储存成一个名为a的向量数据对象，这样我们调用`a`，R就知道要处理的这个向量对象。R是运行在内存里的，也就是说R的数据对象不用储存命令在断电后会丢失，但优点就是不用频繁读取慢的要死的硬盘，加快运行速度。

这时你会说，我的数据都在excel报表里，你不是想我重新输入一遍吧？对啊，重输一遍印象深刻。开个玩笑，现代社会最好不要干自己手动输入的事，一来麻烦，二来也不准，万一你手抖了呢。R比较喜欢纯文本文档，不喜欢自带格式的文档，更不喜欢加密的文档，因为不论哪种文档，最后都要转换成纯文本形式被R读取成数据对象。这里建议大家都把数据储存成csv格式，每一行代表一个样本，每一列代表对样本的一类描述，有了这个前提，后面很多数据清洗的工作就可以省了。我们的读取命令为：

```{r eval=FALSE}
data <- read.csv('path/data.csv')
```

这样我们就可以把某个路径下的数据文件data.csv读取到R中，命名为data。要是想看看data的数据结构，可以用`str(data)`或者`summary(data)`来观察。R是一种高级语言，编程语言越高级，就越像人话。所以你可以猜测`mean()`是求平均值，`sd()`是求标准差。在这方面，多数高级语言都是想通的，程序员虽然不怎么吃人间烟火，但为了跟人打交道，多数常见命令都通用，算是一个语系的，所以你要是有其他高级语言的基础，可以先尝试着来，起码功能相近的函数名都不会差太远。

那么问题来了，我要是打算读取其他格式的文件呢？下面的回答将是本系列文章的一个通用模版，我以后直接以<>来更新关键词：

- 打开搜索引擎
- 输入how to <import XX> in R
- 点击第一个没看过的答案，尝试，不解决问题的话重复这一步直到发疯
- 发疯后点[这里](mailto:yufreecas@gmail.com)告诉我，我会尽一切可能替你联系当地医院

在处理数据时，你会用到一些函数，有些你安装R的时候已经内置了，这时你在函数名前加个问号就能看到该函数的使用方法，如果没有就加两个问号，还没有就说明你需要安装并调用别人用R语言写的软件包，例如我一般用下面的命令：

```{r message=FALSE}
if(!require(knitr)){
        install.packages('knitr')
        library(knitr)
}
```

来安装并调用名为knitr的R语言扩展包，请尝试把knitr替换为其他扩展包名称，这样可以同时完成安装与调用。

好了，有了数据，处理数据的程序我们就可以拿来构建我们的地理信息系统了。

ps: 其余的问题都输入到<>里去搜索吧，这个探索的过程不能省，不然早晚会在某个时候跳出来捅你一刀。